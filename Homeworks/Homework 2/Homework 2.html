<!DOCTYPE html>
<html lang="en"><head>
<script src="Homework 2_files/libs/clipboard/clipboard.min.js"></script>
<script src="Homework 2_files/libs/quarto-html/tabby.min.js"></script>
<script src="Homework 2_files/libs/quarto-html/popper.min.js"></script>
<script src="Homework 2_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Homework 2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Homework 2_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Homework 2_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="Homework 2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.551">

  <meta name="author" content="Jacopo Manenti, id: 247279">
  <meta name="dcterms.date" content="2024-05-02">
  <title>Statistical Learning, Homework #2</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="Homework 2_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="Homework 2_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="Homework 2_files/libs/revealjs/dist/theme/quarto.css">
  <link href="Homework 2_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="Homework 2_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="Homework 2_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="Homework 2_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Statistical Learning, Homework #2</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Jacopo Manenti, id: 247279 
</div>
</div>
</div>

  <p class="date">2024-05-02</p>
</section>
<section id="introduction-and-data-exploration" class="title-slide slide level1 center">
<h1>Introduction and Data Exploration</h1>
<p>In this study, we investigate the prediction of prostate-specific antigen (PSA) value, measured in ng/ml on a logarithmic scale (lpsa), a protein primarily produced by cells within the prostate gland. Elevated levels of PSA may indicate the presence of cancer or other prostate-related conditions. To predict it, we will assess and fit three distinct models: pruned decision tree, random forest, and boosted decision tree. Subsequently, we will evaulate their performance in the final stage and opt for the model exhibiting the lowest test error.</p>
<p>This research is conducted using clinical measurements collected from 97 men scheduled to undergo radical prostatectomy, with the dataset stored in “prostate.csv”. We commence by identifying and addressing any missing data and factorizing <strong>svi</strong> and <strong>gleason</strong> predictors. It’s important to note that variables such as <strong>lcavol</strong>, <strong>lweight</strong>, and <strong>lbph</strong> are logarithmically transformed.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource hscroll number-lines code-with-copy"><code class="sourceCode"><span id="cb1-1"><a href=""></a>[1] "Number of na valuse:  0"</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource hscroll number-lines code-with-copy"><code class="sourceCode"><span id="cb2-1"><a href=""></a>      lcavol  lweight age      lbph svi       lcp gleason pgg45       lpsa</span>
<span id="cb2-2"><a href=""></a>1 -0.5798185 2.769459  50 -1.386294   0 -1.386294       6     0 -0.4307829</span>
<span id="cb2-3"><a href=""></a>2 -0.9942523 3.319626  58 -1.386294   0 -1.386294       6     0 -0.1625189</span>
<span id="cb2-4"><a href=""></a>3 -0.5108256 2.691243  74 -1.386294   0 -1.386294       7    20 -0.1625189</span>
<span id="cb2-5"><a href=""></a>4 -1.2039728 3.282789  58 -1.386294   0 -1.386294       6     0 -0.1625189</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>

<section id="fit-a-decision-tree" class="title-slide slide level1 center">
<h1>Fit a decision tree</h1>
<p>The first model we are going to see is a fully grown decision tree using the entire dataset. These models are straightforward and valuable for interpretation. As illustrated in the figure below, they comprise a series of splitting rules starting from the top of the tree and progressing to the bottom. By visualizing the summary, we can extract useful insights.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource hscroll number-lines code-with-copy"><code class="sourceCode"><span id="cb3-1"><a href=""></a></span>
<span id="cb3-2"><a href=""></a>Regression tree:</span>
<span id="cb3-3"><a href=""></a>tree(formula = lpsa ~ ., data = cancer)</span>
<span id="cb3-4"><a href=""></a>Variables actually used in tree construction:</span>
<span id="cb3-5"><a href=""></a>[1] "lcavol"  "lweight" "pgg45"  </span>
<span id="cb3-6"><a href=""></a>Number of terminal nodes:  9 </span>
<span id="cb3-7"><a href=""></a>Residual mean deviance:  0.4119 = 36.24 / 88 </span>
<span id="cb3-8"><a href=""></a>Distribution of residuals:</span>
<span id="cb3-9"><a href=""></a>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span>
<span id="cb3-10"><a href=""></a>-1.499000 -0.488000  0.003621  0.000000  0.481200  1.380000 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>The summary outlines that the tree has 9 terminal nodes where predictions are taken, and it employed just 3 out of 8 were variables: the cancer’s volume (cm3), the prostate weight (in g), the percentage of Gleason score 4 or 5 over the entire patient’s clinical history. Additionally, the summary provide us with the residual mean deviance, a gauge of model fitting, which stands at 0.4118587. For a better understanding, we can plot the tree and visualize it.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="Homework-2_files/figure-revealjs/plot%20raw%20decision%20tree-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Decision tree indicates higher prostate antigen levels for larger cancer volumes (<span class="math inline">\(lcavol &gt;= e^{2.46}\)</span>), higher Gleason scores (<span class="math inline">\(pgg45 &gt;= 7.5\)</span>), and lower prostate weights (<span class="math inline">\(lweight &lt; e^{3.83}\)</span>). For example, for a patient with a cancer volume between <span class="math inline">\(e^{-0.47}\)</span> and <span class="math inline">\(e^{2.46}\)</span> and a prostate weight <span class="math inline">\(&gt;= e^{3.83}\)</span>, the predicted antigen level is <span class="math inline">\(e^{2.75}\)</span>, or 15.64 ng/ml. Generally, PSA levels below 4.0 ng/ml are considered normal for men. In this case, the test would suggest the presence of prostate condition or cancer.</p>
<p>However, decision trees suffer from high variance, particularly with frequent splits like ours (9 splits), which can result in overfitting and poor test set performance. Pruning the tree after it has fully grown is a common solution to determine the optimal complexity. We use cross-validation to find the best number of terminal nodes, selecting the one with the lowest CV error. Additionally, we visualize this process by plotting the CV error against <code>size</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource hscroll number-lines code-with-copy"><code class="sourceCode"><span id="cb4-1"><a href=""></a></span>
<span id="cb4-2"><a href=""></a>Regression tree:</span>
<span id="cb4-3"><a href=""></a>snip.tree(tree = tree.df, nodes = c(11L, 3L, 10L))</span>
<span id="cb4-4"><a href=""></a>Variables actually used in tree construction:</span>
<span id="cb4-5"><a href=""></a>[1] "lcavol"  "lweight"</span>
<span id="cb4-6"><a href=""></a>Number of terminal nodes:  4 </span>
<span id="cb4-7"><a href=""></a>Residual mean deviance:  0.5625 = 52.31 / 93 </span>
<span id="cb4-8"><a href=""></a>Distribution of residuals:</span>
<span id="cb4-9"><a href=""></a>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span>
<span id="cb4-10"><a href=""></a>-1.66200 -0.54020 -0.01154  0.00000  0.44560  1.81700 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>Cross-validation favored a simpler tree, with 4 terminal nodes. We also observe a rise in residual mean deviance from 0.41 to 0.56, suggesting a worsened model fit. This is due to raw decision trees’ tendency to overfit the dataset. Pruning aims to balance bias and variance, potentially enhancing model performance. Lastly, only <span class="math inline">\(lcavol\)</span> and <span class="math inline">\(lweight\)</span> were significant this time. This leads to an easier intrepretation of the model.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Homework-2_files/figure-revealjs/plot%20pruning%20raw%20recision%20tree-1.png" width="960"></p>
<figcaption>Left: cross-validation for selecting the size; Right: pruned tree distinguishes patients by cancer volume: above <span class="math inline">\(e^{2.46}\)</span> cm³, below <span class="math inline">\(e^{-0.47}\)</span> cm³, and within the latter group, by prostate weight: above <span class="math inline">\(e^{3.68}\)</span> and below. Predicted PSA levels for these groups are <span class="math inline">\(e^{3.7650} = 43.16\)</span>, <span class="math inline">\(e^{0.6017} = 1.82\)</span>, <span class="math inline">\(e^{2.7120} = 15.02\)</span>, and <span class="math inline">\(e^{2.0330} = 7.63\)</span>.</figcaption>
</figure>
</div>
</div>
</div>
</section>

<section id="sec-rf" class="title-slide slide level1 center">
<h1>Fit a random forest</h1>
<p>The second model we fit is random forest, an ensemble method that leverages the concept of averaging <strong>decorrelated</strong> predictions from diverse decision trees to reduce variance and enhance prediction accuracy. Decorrelation implies carefully selecting the number of predictors to consider at each split. In our scenario, this ranges from 1 to 7, as using all 8 predictors would essentially revert to bagging. The rule of thumb in regression is to use <span class="math inline">\(p/3\)</span> variables, which in our case would be <span class="math inline">\(\approx 2\)</span>. However, a better approach involves treating it (<strong>mtry</strong>) as a tuning parameter and finding its optimal value through cross-validation, selecting the one associated with the lowest CV error. The algorithm uses 5 folds and 500 trees.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="Homework-2_files/figure-revealjs/plt%20rf-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
<p>The figure shows the CV error based on the number of variables used for each split, with a vertical line indicating the optimal <strong>mtry</strong> value. These results suggest selecting a random forest generated by utilizing 500 trees and 6 variables for each split.</p>
<p>After optimizing the model, we refit it to analyze each predictor’s importance. However, the interpretability is limited compared to a single decision tree, as visualizing the entire forest is impractical.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="Homework-2_files/figure-revealjs/rf%20importance-1.png" width="960"></p>
<figcaption>The straight line represents the increase in prediction error (MSE), while the circle indicates the node purity (both when the predictor is included and excluded). The results align with previous decision trees: both lcavol and lweight are identified as significant predictors of the protein’s level. However, an additional predictor, previously overlooked, such as svi (seminal vesicle invasion), has now emerged as influential. For instance, removing svi leads to an approximate 9% increase in MSE and a 10% increase in node impurity.</figcaption>
</figure>
</div>
</div>
</div>
<p>The findings in Figure 2 are logical, as these factors significantly influence PSA production and are crucial indicators of prostatic conditions, including cancer. Thus, including them in the PSA prediction model enhances accuracy.</p>
</section>

<section id="fit-a-boosted-regression-tree" class="title-slide slide level1 center">
<h1>Fit a boosted regression tree</h1>
<p>Finally, we apply boosting regression trees, which construct trees sequentially using information from previous trees. Specifically, we use regression gradient boosting (<strong>BRT</strong>). Similar to random forest, BRT requires preliminary hyperparameter tuning, including selecting optimal values for the learning rate, tree complexity, and number of trees. We determine the optimal number of trees through cross-validation <sup>1</sup>, keeping the first parameter as default and aiming for simplicity with only a few splits, typically resulting in three or four regions.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-plotbg" class="quarto-figure quarto-figure-center quarto-float">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-plotbg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="Homework-2_files/figure-revealjs/fig-plotbg-1.png" width="960">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-plotbg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: shows the CV error based on the number of trees used, with a vertical line indicating the optimal <strong>ntrees</strong> value. These results suggest selecting a boosting decision tree utilizing 250 trees, learning rate of 0.01, complexity of 3.
</figcaption>
</figure>
</div>
</div>
</div>
<p>As done with random forest, we refit the model with the optimal configuration and analyze each predictor’s importance.</p>
<div class="cell">
<div class="cell-output-display">
<table>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">var</th>
<th style="text-align: right;">rel.inf</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">lcavol</td>
<td style="text-align: left;">lcavol</td>
<td style="text-align: right;">29.725393</td>
</tr>
<tr class="even">
<td style="text-align: left;">lweight</td>
<td style="text-align: left;">lweight</td>
<td style="text-align: right;">24.562420</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lcp</td>
<td style="text-align: left;">lcp</td>
<td style="text-align: right;">11.988218</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: left;">age</td>
<td style="text-align: right;">9.098943</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pgg45</td>
<td style="text-align: left;">pgg45</td>
<td style="text-align: right;">8.699344</td>
</tr>
<tr class="even">
<td style="text-align: left;">lbph</td>
<td style="text-align: left;">lbph</td>
<td style="text-align: right;">8.185179</td>
</tr>
<tr class="odd">
<td style="text-align: left;">svi</td>
<td style="text-align: left;">svi</td>
<td style="text-align: right;">6.003152</td>
</tr>
<tr class="even">
<td style="text-align: left;">gleason</td>
<td style="text-align: left;">gleason</td>
<td style="text-align: right;">1.737351</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The table ranks variables by their <em>relative influence</em>, indicating their importance in the model. Both <strong>lcavol</strong> and <strong>lweight</strong> are key features, contributing 29% and 24% to the loss function reduction, respectively. These results align with previous findings from random forest. However, <strong>age</strong> is found to be more important than <strong>pgg45</strong> and <strong>svi</strong>. This conclusion seems reasonable, as age influences the normal level of PSA production in men, which typically decreases with age. Therefore, if two individuals have the same level of PSA but different ages, the older individual may face a higher risk.</p>
<aside><ol class="aside-footnotes"><li id="fn1"><p>No boosting cross-validation code reported, as requires little changes from loop in <a href="#/sec-rf" class="quarto-xref">Section&nbsp;3</a> in the fitting function (gbm) and hyperparameter sequence from 50 to 2000. See GitHub for details.</p></li></ol></aside></section>

<section id="compare-the-performance" class="title-slide slide level1 center">
<h1>Compare the performance</h1>
<p>Once we have assessed the optimal configuration for each of our three models, we may consider proceeding with selecting the best model in terms of prediction’s performance. However, these models have been optimized using the entire data set. Therefore, model selection would use the same data to tune model parameters and evaluate model performance, yielding an overly-optimistic score. To mitigate this issue, we employ nested cross-validation (CV), which involves a series of train/validation/test set partitions. This approach an inner loop for model tuning and outer loop for computing the generalization error.</p>
<p>In our scenario, both the inner and outer loops utilize 5-fold cross-validation. We will optimize the model based on specific hyperparameters: <strong>mtry</strong> for random forests, <strong>n.trees</strong> for boosting (while retaining default values for other tuning parameters), and <strong>k</strong> as the complexity parameter for pruning.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb5-2"><a href=""></a></span>
<span id="cb5-3"><a href=""></a><span class="co"># split the data into 5 folds</span></span>
<span id="cb5-4"><a href=""></a>cancer_folds <span class="ot">=</span> <span class="fu">createFolds</span>(cancer<span class="sc">$</span>lpsa, <span class="at">k =</span> <span class="dv">5</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-5"><a href=""></a><span class="co"># set the traincontrol</span></span>
<span id="cb5-6"><a href=""></a>cv_5 <span class="ot">=</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, </span>
<span id="cb5-7"><a href=""></a>                    <span class="at">number =</span> <span class="dv">5</span>,</span>
<span id="cb5-8"><a href=""></a>                    <span class="at">search =</span> <span class="st">"grid"</span>)</span>
<span id="cb5-9"><a href=""></a></span>
<span id="cb5-10"><a href=""></a><span class="co"># collect the predict score got from CV.</span></span>
<span id="cb5-11"><a href=""></a>predicted_rf <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">5</span>, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb5-12"><a href=""></a>predicted_bg <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">5</span>, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb5-13"><a href=""></a>predicted_pr <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span><span class="dv">5</span>, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb5-14"><a href=""></a></span>
<span id="cb5-15"><a href=""></a><span class="co"># set the grid for hyperparamenters' values</span></span>
<span id="cb5-16"><a href=""></a>tune_grid_rf <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">mtry =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)</span>
<span id="cb5-17"><a href=""></a>tune_grid_gb <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">n.trees =</span> <span class="fu">seq</span>(<span class="dv">50</span>,<span class="dv">1000</span>,<span class="at">length=</span><span class="dv">10</span>),<span class="at">interaction.depth =</span> <span class="dv">3</span>,<span class="at">shrinkage =</span> <span class="fl">0.01</span>,<span class="at">n.minobsinnode =</span> <span class="dv">10</span>)</span>
<span id="cb5-18"><a href=""></a>tune_grid_pr <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">cp =</span> <span class="fu">seq</span>(<span class="fl">0.5</span>,<span class="dv">10</span>,<span class="at">length=</span><span class="dv">5</span>))</span>
<span id="cb5-19"><a href=""></a></span>
<span id="cb5-20"><a href=""></a><span class="co"># outer loop</span></span>
<span id="cb5-21"><a href=""></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb5-22"><a href=""></a>  <span class="co"># split dataset into training set and test set</span></span>
<span id="cb5-23"><a href=""></a>  cancer_idx <span class="ot">=</span> <span class="fu">which</span>(cancer_folds <span class="sc">==</span> i)</span>
<span id="cb5-24"><a href=""></a>  cancer_trn <span class="ot">=</span> cancer[<span class="sc">-</span>cancer_idx,]</span>
<span id="cb5-25"><a href=""></a>  cancer_tst <span class="ot">=</span> cancer[cancer_idx,]</span>
<span id="cb5-26"><a href=""></a></span>
<span id="cb5-27"><a href=""></a>  <span class="co"># inner loop for random forest</span></span>
<span id="cb5-28"><a href=""></a>  def_rf <span class="ot">&lt;-</span>  <span class="fu">train</span>(</span>
<span id="cb5-29"><a href=""></a>  lpsa <span class="sc">~</span>., <span class="at">data =</span> cancer_trn,</span>
<span id="cb5-30"><a href=""></a>  <span class="at">method =</span> <span class="st">"rf"</span>,</span>
<span id="cb5-31"><a href=""></a>  <span class="at">trControl =</span> cv_5,</span>
<span id="cb5-32"><a href=""></a>  <span class="at">tuneGrid =</span> tune_grid_rf</span>
<span id="cb5-33"><a href=""></a>  )</span>
<span id="cb5-34"><a href=""></a>  </span>
<span id="cb5-35"><a href=""></a>  <span class="co"># collect the predict score based on random forest optimal model</span></span>
<span id="cb5-36"><a href=""></a>  pred <span class="ot">&lt;-</span>  <span class="fu">predict</span>(def_rf,<span class="at">newdata=</span>cancer_tst)</span>
<span id="cb5-37"><a href=""></a>  predicted_rf[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>((cancer_tst<span class="sc">$</span>lpsa <span class="sc">-</span> pred)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb5-38"><a href=""></a>  </span>
<span id="cb5-39"><a href=""></a>  <span class="co"># inner loop for boosted tree</span></span>
<span id="cb5-40"><a href=""></a>  def_bg <span class="ot">&lt;-</span>  <span class="fu">train</span>(</span>
<span id="cb5-41"><a href=""></a>  lpsa <span class="sc">~</span>., <span class="at">data =</span> cancer_trn,</span>
<span id="cb5-42"><a href=""></a>  <span class="at">method =</span> <span class="st">"gbm"</span>,</span>
<span id="cb5-43"><a href=""></a>  <span class="at">trControl =</span> cv_5,</span>
<span id="cb5-44"><a href=""></a>  <span class="at">tuneGrid =</span> tune_grid_gb</span>
<span id="cb5-45"><a href=""></a>  )</span>
<span id="cb5-46"><a href=""></a>  </span>
<span id="cb5-47"><a href=""></a>  <span class="co"># collect the predict score based on boosted tree optimal model</span></span>
<span id="cb5-48"><a href=""></a>  pred <span class="ot">&lt;-</span>  <span class="fu">predict</span>(def_bg,<span class="at">newdata=</span>cancer_tst)</span>
<span id="cb5-49"><a href=""></a>  predicted_bg[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>((cancer_tst<span class="sc">$</span>lpsa <span class="sc">-</span> pred)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb5-50"><a href=""></a>  </span>
<span id="cb5-51"><a href=""></a>  <span class="co"># inner loop for cost-complexity decision tree</span></span>
<span id="cb5-52"><a href=""></a>  def_pr <span class="ot">&lt;-</span>  <span class="fu">train</span>(</span>
<span id="cb5-53"><a href=""></a>  lpsa <span class="sc">~</span>., <span class="at">data =</span> cancer_trn,</span>
<span id="cb5-54"><a href=""></a>  <span class="at">method =</span> <span class="st">"rpart"</span>,</span>
<span id="cb5-55"><a href=""></a>  <span class="at">trControl =</span> cv_5,</span>
<span id="cb5-56"><a href=""></a>  <span class="at">tuneGrid =</span> tune_grid_pr</span>
<span id="cb5-57"><a href=""></a>  )</span>
<span id="cb5-58"><a href=""></a>  </span>
<span id="cb5-59"><a href=""></a>  <span class="co"># collect the predict score based on ost-complexity decision tree optimal model</span></span>
<span id="cb5-60"><a href=""></a>  pred <span class="ot">&lt;-</span>  <span class="fu">predict</span>(def_pr,<span class="at">newdata=</span>cancer_tst)</span>
<span id="cb5-61"><a href=""></a>  predicted_pr[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>((cancer_tst<span class="sc">$</span>lpsa <span class="sc">-</span> pred)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb5-62"><a href=""></a>}</span>
<span id="cb5-63"><a href=""></a></span>
<span id="cb5-64"><a href=""></a><span class="co"># retrieve the optimal number of variables for random forest</span></span>
<span id="cb5-65"><a href=""></a>rf.opt.mtry<span class="ot">&lt;-</span> def_rf<span class="sc">$</span>bestTune<span class="sc">$</span>mtry</span>
<span id="cb5-66"><a href=""></a><span class="co"># retrieve the optimal number of trees for boosting</span></span>
<span id="cb5-67"><a href=""></a>ns.opt.n.trees<span class="ot">&lt;-</span> <span class="fu">round</span>(def_bg<span class="sc">$</span>bestTune<span class="sc">$</span>n.trees,<span class="dv">0</span>)</span>
<span id="cb5-68"><a href=""></a><span class="co"># retrieve the optimal complexity for pruning</span></span>
<span id="cb5-69"><a href=""></a>pr.opt.k<span class="ot">&lt;-</span> def_pr<span class="sc">$</span>bestTune<span class="sc">$</span>cp</span>
<span id="cb5-70"><a href=""></a><span class="co"># retrive cv- test error from random forest, boosting, pruning</span></span>
<span id="cb5-71"><a href=""></a>rf_cv_test_error <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(predicted_rf),<span class="dv">4</span>)</span>
<span id="cb5-72"><a href=""></a>gb_cv_test_error <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(predicted_bg),<span class="dv">4</span>)</span>
<span id="cb5-73"><a href=""></a>pr_cv_test_error <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(predicted_pr),<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<style type="text/css">
.hscroll {
  overflow-x: auto;
  white-space: nowrap;
}
</style>
</div>
<p>At the conclusion, we have derived the following configurations for model evaluation:</p>
<ul>
<li><p>Random Forest: a random forest employing utilizing 500 trees and 6 variables for each split. The cv-test error is 0.6215</p></li>
<li><p>Boosting: a boosted tree trained with a total of 261 trees, learning rate of 0.01, complexity of 3. The cv-test error is 0.6544</p></li>
<li><p>Cost-Complexity Decision Tree: utilizing a complexity parameter set at 10, which produces a pruned tree with 3 regions that utilizes only lcavol predictor. The cv-test error is 1.3318.</p></li>
</ul>
</section>

<section id="conclusions" class="title-slide slide level1 center">
<h1>Conclusions</h1>
<p>In this study, we examined three methods for predicting prostate antigen values using clinical measurements. We started with a decision tree, then transitioned to a pruned tree to address overfitting. Additionally, we explored two ensemble methods to reduce the variance of basic decision trees. Due to the small dataset size, nested cross-validation helped select the best hyperparameters and provided an unbiased estimate of model performance. Comparing test errors, random forest showed the lowest, leading to its selection for better generalization performance. Although it may be the optimal choice, its interpretability is lower than a single decision tree, which could be critical in medical applications. Furthermore, another limitation of the analysis is related to the fact that we only tuned specific parameters of random forest and boosting, leaving some as default (e.g., learning rate in boosting), which could have influenced the model selection differently.</p>
<p>In conclusion, we fit the selected optimal model to the entire dataset and subsequently generate predictions on a new observation to see how the it performs.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource hscroll number-lines code-with-copy"><code class="sourceCode"><span id="cb6-1"><a href=""></a>[1] "The model has predicted a level of log prostate antigen of 4.0762"</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
</section>


    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="Homework 2_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="Homework 2_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="Homework 2_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="Homework 2_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="Homework 2_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="Homework 2_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="Homework 2_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="Homework 2_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="Homework 2_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="Homework 2_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1920,

        height: 1080,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>